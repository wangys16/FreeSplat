[2024-10-22 14:22:24,534][py.warnings][WARNING] - /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/wang/lab/freesplat_github/src/main.py +experim ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs

[2024-10-22 14:22:24,541][py.warnings][WARNING] - /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/timm/models/_factory.py:117: UserWarning: Mapping deprecated model name tf_efficientnetv2_s_in21ft1k to current tf_efficientnetv2_s.in21k_ft_in1k.
  model = create_fn(

[2024-10-22 14:22:24,726][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/tf_efficientnetv2_s.in21k_ft_in1k)
[2024-10-22 14:22:24,985][timm.models._hub][INFO] - [timm/tf_efficientnetv2_s.in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-10-22 14:22:25,018][timm.models._builder][WARNING] - Unexpected keys (bn2.bias, bn2.num_batches_tracked, bn2.running_mean, bn2.running_var, bn2.weight, classifier.bias, classifier.weight, conv_head.weight) found while loading pretrained weights. This may be expected if model is being adapted.
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
[2024-10-22 14:22:25,211][py.warnings][WARNING] - /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(

[2024-10-22 14:22:25,211][py.warnings][WARNING] - /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

Loading model from: /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
dataset:
    view_sampler: {'name': 'evaluation', 'index_path': 'assets/evaluation_index_scannet.json', 'num_context_views': 2}
    name: scannet
    make_baseline_1: False
    augment: True
    image_shape: [384, 512]
    background_color: [0.0, 0.0, 0.0]
    cameras_are_circular: False
    baseline_epsilon: 0.001
    max_fov: 100.0
    load_depth: True
    overfit_to_scene: None
    roots: ['/home/wang/ssd/scannet/scannet_surn/scannet']
    near: 0.5
    far: 15.0
model:
    encoder: {'backbone': {'name': 'efficientnet', 'model': 'efficientnet', 'd_out': 512}, 'name': 'freesplat', 'opacity_mapping': {'initial': 0.0, 'final': 0.0, 'warm_up': 1}, 'num_surfaces': 1, 'gaussian_adapter': {'gaussian_scale_min': 0.5, 'gaussian_scale_max': 15.0, 'sh_degree': 2}, 'd_feature': 128, 'visualizer': {'num_samples': 8, 'min_resolution': 256, 'export_ply': False}, 'num_views': 2, 'num_depth_candidates': 128}
    decoder: {'name': 'splatting_cuda'}
loss:
    mse: {'weight': 1.0}
    lpips: {'weight': 0.05, 'apply_after_step': 0}
output_dir: test_scannet_2views
wandb:
    project: freesplat
    entity: placeholder
    name: scannet
    mode: offline
    tags: ['scannet', '384x512']
mode: test
data_loader:
    train: {'num_workers': 16, 'persistent_workers': True, 'batch_size': 1, 'seed': 1234}
    test: {'num_workers': 4, 'persistent_workers': False, 'batch_size': 1, 'seed': 2345}
    val: {'num_workers': 1, 'persistent_workers': True, 'batch_size': 1, 'seed': 3456}
optimizer:
    lr: 0.0001
    warm_up_steps: 100
    cosine_lr: True
checkpointing:
    load: ../checkpoints/2views.ckpt
    every_n_train_steps: 10000
    save_top_k: -1
train:
    load_depth: None
    depth_mode: depth
    extended_visualization: False
    has_depth: True
test:
    output_path: outputs/test
seed: 111123
trainer:
    max_steps: 300001
    val_check_interval: 5000
    gradient_clip_val: 0.01
    prog_bar: True
You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Restoring states from the checkpoint path at ../checkpoints/2views.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at ../checkpoints/2views.ckpt
--------------------index_path: assets/evaluation_index_scannet.json
--------------------data root: /home/wang/ssd/scannet/scannet_surn/scannet
Test step 000000.
[2024-10-22 14:22:28,127][py.warnings][WARNING] - /home/wang/lab/freesplat_github/src/model/encoder/common/gaussian_adapter.py:36: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  i_coords, j_coords = torch.meshgrid(torch.range(0,height-1), torch.range(0,width-1), indexing='ij')

processing scene0000_01_0
abs_diff: 0.08662374317646027, rel_diff: 0.04280493035912514, delta_25: 0.9806234240531921, delta_10: 0.9302326440811157
[2024-10-22 14:22:28,716][py.warnings][WARNING] - /home/wang/lab/freesplat_github/src/model/model_wrapper.py:55: RuntimeWarning: divide by zero encountered in divide
  disp_map = 1/depth_map

Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/wang/anaconda3/envs/freesplat/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
psnr: 25.069232940673828 ssim: 0.8005415201187134 lpips: 0.23106302320957184 num: 2
processing scene0000_01_1
abs_diff: 0.09341147541999817, rel_diff: 0.0482703372836113, delta_25: 0.9348669052124023, delta_10: 0.9066351652145386
psnr: 25.89119529724121 ssim: 0.7782613039016724 lpips: 0.2396511286497116 num: 3
processing scene0000_01_2
abs_diff: 0.18862414360046387, rel_diff: 0.09407829493284225, delta_25: 0.9026819467544556, delta_10: 0.6922320127487183

Detected KeyboardInterrupt, attempting graceful shutdown ...
